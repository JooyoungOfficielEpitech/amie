<!DOCTYPE html>
<html>
<head>
    <title>ë§¤ì¹­ ì›¹ì†Œì¼“ í…ŒìŠ¤íŠ¸</title>
    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        #console { height: 400px; overflow-y: auto; background-color: #f0f0f0; padding: 10px; border-radius: 5px; }
        .container { max-width: 800px; margin: 0 auto; }
        button { margin: 5px; padding: 10px; }
        input { padding: 8px; width: 200px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>AmiÃ© ë§¤ì¹­ ì›¹ì†Œì¼“ í…ŒìŠ¤íŠ¸</h1>
        
        <div>
            <label for="token">í† í°:</label>
            <input type="text" id="token" placeholder="JWT í† í° ì…ë ¥">
            <button onclick="connectSocket()">ì—°ê²°</button>
            <button onclick="disconnectSocket()">ì—°ê²° í•´ì œ</button>
        </div>
        
        <h3>ë§¤ì¹­ ê¸°ëŠ¥</h3>
        <div>
            <button onclick="requestMatching()">ë§¤ì¹­ ìš”ì²­</button>
            <button onclick="checkMatchStatus()">ë§¤ì¹­ ìƒíƒœ í™•ì¸</button>
            <button onclick="cancelMatching()">ë§¤ì¹­ ì·¨ì†Œ</button>
        </div>
        
        <h3>ë¡œê·¸</h3>
        <div id="console"></div>
    </div>

    <script>
        let socket;
        let matchSocket;
        
        function log(message) {
            const consoleDiv = document.getElementById('console');
            const timestamp = new Date().toLocaleTimeString();
            consoleDiv.innerHTML += `<div>[${timestamp}] ${message}</div>`;
            consoleDiv.scrollTop = consoleDiv.scrollHeight;
        }
        
        function connectSocket() {
            try {
                const token = document.getElementById('token').value;
                if (!token) {
                    log('âš ï¸ í† í°ì„ ì…ë ¥í•˜ì„¸ìš”');
                    return;
                }
                
                log('ğŸ”Œ ì„œë²„ì— ì—°ê²° ì¤‘...');
                
                // ê¸°ë³¸ ì†Œì¼“ ì—°ê²°
                socket = io('http://localhost:3001', {
                    auth: {
                        token: token
                    }
                });
                
                socket.on('connect', () => {
                    log('âœ… ë©”ì¸ ì†Œì¼“ ì—°ê²° ì„±ê³µ');
                });
                
                socket.on('connect_error', (err) => {
                    log(`âŒ ì—°ê²° ì˜¤ë¥˜: ${err.message}`);
                });
                
                // ë§¤ì¹­ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ì—°ê²°
                matchSocket = io('http://localhost:3001/match', {
                    auth: {
                        token: token
                    }
                });
                
                matchSocket.on('connect', () => {
                    log('âœ… ë§¤ì¹­ ì†Œì¼“ ì—°ê²° ì„±ê³µ');
                });
                
                matchSocket.on('connect_error', (err) => {
                    log(`âŒ ë§¤ì¹­ ì†Œì¼“ ì—°ê²° ì˜¤ë¥˜: ${err.message}`);
                });
                
                // ë§¤ì¹­ ê´€ë ¨ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡
                matchSocket.on('matchStatus', (data) => {
                    log(`ğŸ“Š ë§¤ì¹­ ìƒíƒœ ì—…ë°ì´íŠ¸: ${JSON.stringify(data)}`);
                });
                
                matchSocket.on('matchFound', (data) => {
                    log(`âœ¨ ë§¤ì¹­ ì°¾ìŒ: ${JSON.stringify(data)}`);
                });
                
                matchSocket.on('matchCancelled', (data) => {
                    log(`ğŸš« ë§¤ì¹­ ì·¨ì†Œë¨: ${JSON.stringify(data)}`);
                });
                
                matchSocket.on('error', (error) => {
                    log(`âŒ ë§¤ì¹­ ì—ëŸ¬: ${error}`);
                });
            } catch (error) {
                log(`âŒ ì—°ê²° ì˜¤ë¥˜: ${error.message}`);
            }
        }
        
        function disconnectSocket() {
            if (matchSocket) {
                matchSocket.disconnect();
                log('ğŸ”Œ ë§¤ì¹­ ì†Œì¼“ ì—°ê²° í•´ì œ');
            }
            
            if (socket) {
                socket.disconnect();
                log('ğŸ”Œ ë©”ì¸ ì†Œì¼“ ì—°ê²° í•´ì œ');
            }
        }
        
        function requestMatching() {
            if (!matchSocket || !matchSocket.connected) {
                log('âš ï¸ ë§¤ì¹­ ì†Œì¼“ì´ ì—°ê²°ë˜ì–´ ìˆì§€ ì•ŠìŠµë‹ˆë‹¤');
                return;
            }
            
            log('ğŸ” ë§¤ì¹­ ìš”ì²­ ì¤‘...');
            matchSocket.emit('request-match', {}, (response) => {
                log(`ğŸ“£ ë§¤ì¹­ ìš”ì²­ ì‘ë‹µ: ${JSON.stringify(response)}`);
            });
        }
        
        function checkMatchStatus() {
            if (!matchSocket || !matchSocket.connected) {
                log('âš ï¸ ë§¤ì¹­ ì†Œì¼“ì´ ì—°ê²°ë˜ì–´ ìˆì§€ ì•ŠìŠµë‹ˆë‹¤');
                return;
            }
            
            log('ğŸ” ë§¤ì¹­ ìƒíƒœ í™•ì¸ ì¤‘...');
            matchSocket.emit('check-match-status', {}, (response) => {
                log(`ğŸ“£ ë§¤ì¹­ ìƒíƒœ: ${JSON.stringify(response)}`);
            });
        }
        
        function cancelMatching() {
            if (!matchSocket || !matchSocket.connected) {
                log('âš ï¸ ë§¤ì¹­ ì†Œì¼“ì´ ì—°ê²°ë˜ì–´ ìˆì§€ ì•ŠìŠµë‹ˆë‹¤');
                return;
            }
            
            log('ğŸš« ë§¤ì¹­ ì·¨ì†Œ ì¤‘...');
            matchSocket.emit('cancel-match', {}, (response) => {
                log(`ğŸ“£ ë§¤ì¹­ ì·¨ì†Œ ì‘ë‹µ: ${JSON.stringify(response)}`);
            });
        }
    </script>
</body>
</html> 